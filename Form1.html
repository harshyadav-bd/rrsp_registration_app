<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      max-width: 600px;
      width: 100%;
      background-color: #fff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      padding: 20px 40px 40px 40px;
      border-radius: 8px;
      box-sizing: border-box;
      text-align: center;
    }
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo img {
      max-width: 100%; 
      height: auto;
    }
    h2 {
      font-size: 24px;
      color: #333;
      margin-bottom: 20px;
    }
    label {
      text-align: left;
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
      font-size: 14px;
    }
    input[type="button"] {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
      padding: 12px;
      transition: background-color 0.3s;
    }
    input[type="button"]:hover {
      background-color: #0056b3;
    }
    input[type="button"]:active {
      background-color: #004085;
    }
    .success-message {
      display: none;
      background-color: #d4edda;
      color: #155724;
      padding: 15px;
      margin-top: 20px;
      border-radius: 5px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo" id="logoContainer">
      <img src="https://lh3.googleusercontent.com/d/1PWA1M0-RgffWznEMCygAxsjKjLOTFi0H" alt="Logo">
    </div>
    <h2>Employer RRSP Enrollment</h2>
    <form id="form1">
      <label for="formFillerName">Form Filler Name:</label>
      <input type="text" name="formFillerName" required><br>
      
      <label for="formFillerEmail">Form Filler Email:</label>
      <input type="email" name="formFillerEmail" required><br>
      
      <label for="companyName">Company Name:</label>
      <input type="text" name="companyName" required><br>
      
      <label for="employeeName">Employee Name:</label>
      <input type="text" name="employeeName" required><br>
      
      <label for="previouslyFilledForm">Have you filled this form Previously:</label>
      <select name="previouslyFilledForm" id="previouslyFilledForm" required onchange="toggleAdditionalQuestions()">
        <option value="">Select</option>
        <option value="yes">Yes (You don't have to fill the form again)</option>
        <option value="no">No</option>
      </select><br>
      
      <div id="additionalQuestions" class="hidden">
      <label for="planChoice">What Plan Are You Choosing for Your Employees?</label>
      <select name="planChoice" id="planChoice" required>
        <option value="">Select</option>
        <option value="0% No Employer Match/Employee-Only Contribution">0% No Employer Match/Employee-Only Contribution</option>
        <option value="2% Matching Plan">2% Matching Plan</option>
        <option value="3% Matching Plan">3% Matching Plan</option>
        <option value="5% Matching Plan">5% Matching Plan</option>
      </select><br>

      <label for="agreeTerms">This plan option will apply to both current and future employees by default, unless you choose to opt out of this benefit. If you agree, please indicate by checking the box below.</label>
      <label><input type="checkbox" name="agreeTerms" required> I understand</label><br>
    </div>
      
      <input type="submit" value="Submit Form" onclick="confirmSubmit()">
    </form>
        <div id="successMessage" class="success-message">Your Form has been submitted!</div>
  </div>

  <script>
    function confirmSubmit(event) {
      // Check if the form is valid
      if (document.getElementById('form1').checkValidity()) {
        if (confirm("I have reviewed all of the details and I can confirm that everything is correct?")) {
          handleSubmit();
        }
      }
      // Prevent the default form submission for further custom handling
      return false;
    }

    function handleSubmit() {
      const formData = new FormData(document.getElementById('form1'));
      google.script.run
        .withSuccessHandler(onSuccess)
        .withFailureHandler(onFailure)
        .processForm1(Object.fromEntries(formData));
    }

    function onSuccess(msg) {
      document.getElementById('form1').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('successMessage').textContent = msg;
    }

    function onFailure(error) {
      alert('An error occurred: ' + error.message);
    }

    function loadLogo() {
      var img = document.querySelector('.logo img');
      img.onerror = function() {
        console.error('Failed to load logo');
        img.style.display = 'none';
      };
    }

    function toggleAdditionalQuestions() {
      var previouslyFilledForm = document.getElementById("previouslyFilledForm").value;
      var additionalQuestionsDiv = document.getElementById("additionalQuestions");

      if (previouslyFilledForm === "no") {
        additionalQuestionsDiv.classList.remove("hidden");
      } else {
        additionalQuestionsDiv.classList.add("hidden");
      }
    }

    window.onload = loadLogo;
  </script>    
</body>
</html>
