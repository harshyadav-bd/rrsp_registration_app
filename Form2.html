<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f4f4f9;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      max-width: 600px;
      width: 100%;
      background-color: #fff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      padding: 20px 40px 40px 40px;
      border-radius: 8px;
      box-sizing: border-box;
      text-align: center;
    }
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo img {
      max-width: 100%; 
      height: auto;
    }
    h2 {
      font-size: 24px;
      color: #333;
      margin-bottom: 20px;
    }
    label {
      text-align: left;
      display: block;
      margin-bottom: 8px;
      font-weight: bold;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
      font-size: 14px;
    }
    input[type="submit"] {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
      padding: 12px;
      transition: background-color 0.3s;
    }
    input[type="submit"]:hover {
      background-color: #0056b3;
    }
    input[type="submit"]:active {
      background-color: #004085;
    }
    .success-message {
      display: none;
      background-color: #d4edda;
      color: #155724;
      padding: 15px;
      margin-top: 20px;
      border-radius: 5px;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo" id="logoContainer">
      <img src="https://lh3.googleusercontent.com/d/1PWA1M0-RgffWznEMCygAxsjKjLOTFi0H" alt="Logo">
    </div>
    <h2>Employee RRSP Enrollment</h2>
    <form id="form2" onsubmit="return confirmSubmit()">
      <label for="formFillerName">Form Filler Name:</label>
      <input type="text" name="formFillerName" required><br>
      
      <label for="formFillerEmail">Form Filler Email:</label>
      <input type="email" name="formFillerEmail" required><br>
      
      <label for="companyName">Company Name:</label>
      <input type="text" name="companyName" required><br>
      
      <label for="employeeName">Employee Name:</label>
      <input type="text" name="employeeName" required><br>
      
      <div id="additionalQuestions">
        <label for="planChoice">How much would you like to contribute</label>
        <select name="planChoice" id="planChoice" onchange="toggleCustomField()" required>
          <option value="">Select</option>
          <option value="Same as Employer">Same as Employer</option>
          <option value="1% Additional">1% Additional</option>
          <option value="2% Additional">2% Additional</option>
          <option value="3% Additional">3% Additional</option>
          <option value="Custom">Custom</option>
        </select><br>

        <div id="customPercentageField" class="hidden">
          <label for="customPercentage">Enter custom percentage:</label>
          <input type="text" name="customPercentage" id="customPercentage"><br>
        </div>
      </div>
      
      <input type="submit" value="Submit Form">
    </form>
    <div id="successMessage" class="success-message">Please finalize your enrollment by going direct to the link below</div>
  </div>

  <script>
    function confirmSubmit() {
      // Check if the form is valid
      if (document.getElementById('form2').checkValidity()) {
        if (confirm("I have reviewed all of the details and I can confirm that everything is correct?")) {
          handleSubmit();
        }
        return false; // Prevents the default form submission
      }
    }

    function handleSubmit() {
      const formData = new FormData(document.getElementById('form2'));
      google.script.run
        .withSuccessHandler(onSuccess)
        .withFailureHandler(onFailure)
        .processForm2(Object.fromEntries(formData));
    }

    function onSuccess(msg) {
      document.getElementById('form2').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';
      document.getElementById('successMessage').textContent = msg;
    }

    function onFailure(error) {
      alert('An error occurred: ' + error.message);
    }

    function loadLogo() {
      var img = document.querySelector('.logo img');
      img.onerror = function() {
        console.error('Failed to load logo');
        img.style.display = 'none';
      };
    }
    
    window.onload = loadLogo;

    function toggleCustomField() {
      var planChoice = document.getElementById('planChoice').value;
      var customField = document.getElementById('customPercentageField');
      if (planChoice === 'Custom') {
        customField.classList.remove('hidden');
      } else {
        customField.classList.add('hidden');
      }
    }
  </script>
</body>
</html>
